using MalwareScanner.Contracts;

namespace MalwareScanner.Scanners.Amsi
{
	public class AmsiMalwareScanningResult : IMalwareScanningResult
	{
		public AmsiMalwareScanningResult(AMSI_RESULT res)
		{
			if (res == AMSI_RESULT.AMSI_RESULT_NOT_DETECTED || res == AMSI_RESULT.AMSI_RESULT_CLEAN)
			{
				this.IsSafe = true;
			}

			if (res >= AMSI_RESULT.AMSI_RESULT_BLOCKED_BY_ADMIN_START && res <= AMSI_RESULT.AMSI_RESULT_BLOCKED_BY_ADMIN_END
				|| res >= AMSI_RESULT.AMSI_RESULT_DETECTED)
			{
				this.IsSafe = false;
			}
		}

		public bool IsSafe { get; private set; }
	}
}
