using System;
using System.IO;
using System.Text;
using MalwareScanner.Contracts;
using MalwareScanner.Scanners.Amsi;

namespace MalwareScanner
{
	class Program
	{
		static void Main(string[] args)
		{
			var buf = Encoding.UTF8.GetBytes(@"X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*");
			using (var scanner = new AmsiMalwareScanner())
			{
				IMalwareScanningResult res = scanner.Scan(() => new MemoryStream(buf));

				Console.WriteLine("File is safe: {0}", res.IsSafe);
			}
		}
	}
}
